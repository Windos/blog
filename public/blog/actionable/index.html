<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.png">

  <title>
  Actionable Toast Notifications, Finally Cracked Them! - ToastIT
  </title>
  <meta name="description" content="I don&rsquo;t know how to express a happy dance with text. If I could that&rsquo;s what would be here because I&rsquo;ve finally removed a thorn from my side that&rsquo;s been there for five years." /><meta name="generator" content="Hugo 0.108.0"><link
    rel="stylesheet"
    href="https://blog.toastit.dev/css/styles.min.00926f5a77daea6f795528dd203f08541988d4f18173be6e98b840cc57cd6ad6.css"
    integrity="sha256-AJJvWnfa6m95VSjdID8IVBmI1PGBc75umLhAzFfNatY="
  />



  <meta property="og:title" content="Actionable Toast Notifications, Finally Cracked Them!" />
<meta property="og:description" content="I don&rsquo;t know how to express a happy dance with text. If I could that&rsquo;s what would be here because I&rsquo;ve finally removed a thorn from my side that&rsquo;s been there for five years." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.toastit.dev/blog/actionable/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2020-08-07T17:54:01+00:00" />
<meta property="article:modified_time" content="2020-08-07T17:54:01+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Actionable Toast Notifications, Finally Cracked Them!"/>
<meta name="twitter:description" content="I don&rsquo;t know how to express a happy dance with text. If I could that&rsquo;s what would be here because I&rsquo;ve finally removed a thorn from my side that&rsquo;s been there for five years."/>

  <meta itemprop="name" content="Actionable Toast Notifications, Finally Cracked Them!">
<meta itemprop="description" content="I don&rsquo;t know how to express a happy dance with text. If I could that&rsquo;s what would be here because I&rsquo;ve finally removed a thorn from my side that&rsquo;s been there for five years."><meta itemprop="datePublished" content="2020-08-07T17:54:01+00:00" />
<meta itemprop="dateModified" content="2020-08-07T17:54:01+00:00" />
<meta itemprop="wordCount" content="1767">
<meta itemprop="keywords" content="PowerShell,BurntToast," />


</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="https://blog.toastit.dev/" class="capitalize font-extrabold text-2xl">

    <img src="/toastit-logo.png" alt="ToastIT" class="h-8 max-w-full" />

  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">


    <li><a href="/blog">Blog</a></li>

    <li><a href="/page/about/">About</a></li>

    <li><a href="/tags">Tags</a></li>

    <li><a href="/blog/emoji-support/">Top Post</a></li>





    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>



  </ul>
</header>
<main class="flex-1">





  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Actionable Toast Notifications, Finally Cracked Them!</h1>

    <h5 class="text-sm flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Posted on

    August 7, 2020




        &nbsp;&bull;&nbsp;

      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      9&nbsp;minutes
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      1767&nbsp;words



    </h5>


    <p>I&rsquo;ve been living and breathing toast notifications while building the <a href="https://www.powershellgallery.com/packages/BurntToast" target="_blank" rel="noopener">BurntToast</a>
 module for the past five years. Through this time, they&rsquo;ve been great for delivering information&hellip; or annoying users.</p>
<p>But there has always been a lingering missing piece: &ldquo;Can I <em>do</em> something with these notifications?&rdquo;</p>
<p>Sure, you could always put buttons on your toast notifications. But they were limited to snoozing and dismissing the notification itself or opening files or websites in their default applications.</p>
<p>Again, this is limiting us to just delivering information. What if you wanted to pop a notification telling the user they needed to reboot and providing them with a button which would carry out that reboot?</p>
<h2 id="actions-via-protocol-handlers">Actions Via Protocol Handlers</h2>
<p>One way of enabling actionable toast notifications is the use of <a href="https://docs.microsoft.com/en-us/windows/win32/search/-search-3x-wds-extidx-prot-implementing" target="_blank" rel="noopener">protocol handlers</a>
. These are a very important and valid method, but I feel like the barrier to entry here is a bit higher than it should be.</p>
<p>I will be documenting this method more in the future and writing a helper module to make using them easier. For now, <a href="https://twitter.com/adamdriscoll" target="_blank" rel="noopener">Adam Driscoll</a>
 did an excellent job of demonstrating their use with BurntToast during one of his Module Monday videos.</p>
<iframe width="480" height="270" src="https://www.youtube.com/embed/TwZjr66yfc8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>These allow you to trigger scripts and take actions based on clicking directly on a toast notification or custom buttons that&rsquo;ve been added to it.</p>
<p>But what about selection boxes? What if you want to take an action if the user dismissed the notification?</p>
<h2 id="object-events">Object Events</h2>
<p>If you&rsquo;ve been following my quest for actionable notifications over the years, you may have seen a screenshot like this.</p>
<figure><img src="/2020/08/image.png"
         alt="Seeing this still irks me despite knowing where this post is going."/><figcaption>
            <p>Seeing this still irks me despite knowing where this post is going.</p>
        </figcaption>
</figure>

<p>Toasts are a Windows RT (WinRT) feature, and their associated events are WinRT events. PowerShell cannot subscribe to those events&hellip; until now (sort of, but we&rsquo;re not peaking too far behind the curtains today.)</p>
<p>Before we dive into this, I need to dash some hopes that may be building. What follows is only possible using <a href="https://github.com/Windos/BurntToast/releases/tag/v0.7.2" target="_blank" rel="noopener">BurntToast v0.7.2</a>
 with <a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener">PowerShell</a>
 7.1 (from Preview 4 and above).</p>
<p>But PowerShell 7 is great and once you&rsquo;ve made the leap to that then following the updates is relatively painless.</p>
<p>Now to build hopes back up, assuming you&rsquo;re running the required versions, here&rsquo;s a taste of what you can now do:</p>
<figure><img src="/2020/08/2020-08-06_23-03-10.gif"/>
</figure>

<p>That right there is a working selection box. A second toast is triggered by the activation (button click) of the first toast, based on the selected item.</p>
<p>It may seem like such a simple thing, but this unlocks <strong>limitless potential</strong>.</p>
<p>That may sound corny, but it&rsquo;s true. If you can think of some action you want to take based on a toast, you can do it now. Whether it be as simple as acting based on whether a toast of clicked or not, or what a user selected from a selection list, or the text they entered into a text input box.</p>
<h2 id="do-it-yourself">Do It Yourself</h2>
<p>I&rsquo;m going to blast through a lot of the cmdlets being used here, as their use is described in <a href="__GHOST_URL__/2020/07/29/anatomy-of-toast/">The Anatomy of Toast</a>
, and mainly focus on the new stuff.</p>
<p>Start with the text, emails, and audio for your toast, then put those into both a binding and a visual element.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Text1</span> = <span style="color:#8be9fd;font-style:italic">New-BTText</span> -Content <span style="color:#f1fa8c">&#39;New Batch of GIFs&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$ImagePath</span> = <span style="color:#f1fa8c">&#39;C:\Program Files\PowerShell\7-preview\assets\Powershell_av_colors.ico&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Image1</span> = <span style="color:#8be9fd;font-style:italic">New-BTImage</span> -Source <span style="color:#8be9fd;font-style:italic">$ImagePath</span> -AppLogoOverride -Crop None
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Audio1</span> = <span style="color:#8be9fd;font-style:italic">New-BTAudio</span> -Source <span style="color:#f1fa8c">&#39;ms-winsoundevent:Notification.Default&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Binding1</span> = <span style="color:#8be9fd;font-style:italic">New-BTBinding</span> -Children <span style="color:#8be9fd;font-style:italic">$Text1</span> -AppLogoOverride <span style="color:#8be9fd;font-style:italic">$Image1</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Visual1</span> = <span style="color:#8be9fd;font-style:italic">New-BTVisual</span> -BindingGeneric <span style="color:#8be9fd;font-style:italic">$Binding1</span>
</span></span></code></pre></div><p>Now for something new, create each of the items for your dropdown selection box. Do this with the <code>New-BTSelectionBoxItem</code> cmdlet, supplying a unique ID for each. The content parameter is what will be shown to the user.</p>
<p>With all of the items created, add them to an &ldquo;input&rdquo; object with the <code>New-BTInput</code> cmdlet. Providing an ID is mandatory, but the title is optional and will be displayed above the selection box if specified.</p>
<p>You specify each of your selection box items against the item parameter, the order you provide them will be the order that they&rsquo;re displayed. Finally, you can optionally supply the ID of the item you want selected by default.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Item1</span> = <span style="color:#8be9fd;font-style:italic">New-BTSelectionBoxItem</span> -Id <span style="color:#f1fa8c">&#39;Item1&#39;</span> -Content <span style="color:#f1fa8c">&#39;Picard Facepalm&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Item2</span> = <span style="color:#8be9fd;font-style:italic">New-BTSelectionBoxItem</span> -Id <span style="color:#f1fa8c">&#39;Item2&#39;</span> -Content <span style="color:#f1fa8c">&#39;Get It Girl&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Item3</span> = <span style="color:#8be9fd;font-style:italic">New-BTSelectionBoxItem</span> -Id <span style="color:#f1fa8c">&#39;Item3&#39;</span> -Content <span style="color:#f1fa8c">&#39;Seinfeld - Oh, right right right&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Item4</span> = <span style="color:#8be9fd;font-style:italic">New-BTSelectionBoxItem</span> -Id <span style="color:#f1fa8c">&#39;Item4&#39;</span> -Content <span style="color:#f1fa8c">&#39;Bob Ross?&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$InputSplat</span> = @{
</span></span><span style="display:flex;"><span>    Id    = <span style="color:#f1fa8c">&#39;Selection001&#39;</span>
</span></span><span style="display:flex;"><span>    Title = <span style="color:#f1fa8c">&#39;Select a GIF to view now&#39;</span>
</span></span><span style="display:flex;"><span>    DefaultSelectionBoxItemId = <span style="color:#f1fa8c">&#39;Item1&#39;</span>
</span></span><span style="display:flex;"><span>    Items = <span style="color:#8be9fd;font-style:italic">$Item1</span>, <span style="color:#8be9fd;font-style:italic">$Item2</span>, <span style="color:#8be9fd;font-style:italic">$Item3</span>, <span style="color:#8be9fd;font-style:italic">$Item4</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$BTInput</span> = <span style="color:#8be9fd;font-style:italic">New-BTInput</span> <span style="color:#8be9fd;font-style:italic">@InputSplat</span>
</span></span></code></pre></div><p>Next we need a pair of buttons. One is a standard dismiss button and the other is a submit button. What makes it a &ldquo;submit&rdquo; button? The fact that it shows Submit on the button itself. The argument is required, but in this case it doesn&rsquo;t matter what it is set to.</p>
<p>With our two buttons created, we add them to an &ldquo;action&rdquo; object alongside the previously created input object.</p>
<p>And then everything we&rsquo;ve created so far is bundled up into a &ldquo;content&rdquo; object.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Submit</span> = <span style="color:#8be9fd;font-style:italic">New-BTButton</span> -Content <span style="color:#f1fa8c">&#39;Submit&#39;</span> -Arguments <span style="color:#f1fa8c">&#39;SubmitButton&#39;</span> -ActivationType Foreground
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Dismiss</span> = <span style="color:#8be9fd;font-style:italic">New-BTButton</span> -Dismiss
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Actions1</span> = <span style="color:#8be9fd;font-style:italic">New-BTAction</span> -Inputs <span style="color:#8be9fd;font-style:italic">$Input1</span> -Buttons <span style="color:#8be9fd;font-style:italic">$Submit</span>, <span style="color:#8be9fd;font-style:italic">$Dismiss</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Content1</span> = <span style="color:#8be9fd;font-style:italic">New-BTContent</span> -Visual <span style="color:#8be9fd;font-style:italic">$Visual1</span> -Audio <span style="color:#8be9fd;font-style:italic">$Audio1</span> -Actions <span style="color:#8be9fd;font-style:italic">$Actions1</span>
</span></span></code></pre></div><p>Because things are in limbo at the moment, we have to take some manual action to pop our notification. This is because we need to get access to the raw ToastNotification object which we normally don&rsquo;t interact with if using <code>Submit-BTNotification</code>.</p>
<p>This means we have to manually &ldquo;clean up&rdquo; the XML that describes our toast before creating the toast object itself with it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$Content1</span>.GetContent().Replace(<span style="color:#f1fa8c">&#39;&lt;text&gt;{&#39;</span>, <span style="color:#f1fa8c">&#39;&lt;text&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;}&lt;/text&gt;&#39;</span>, <span style="color:#f1fa8c">&#39;&lt;/text&gt;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;=&#34;{&#39;</span>, <span style="color:#f1fa8c">&#39;=&#34;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;}&#34; &#39;</span>, <span style="color:#f1fa8c">&#39;&#34; &#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$AppId</span> = <span style="color:#f1fa8c">&#39;Microsoft.AutoGenerated.{CD9EFC53-1ACE-EA00-530A-3EC179D1971C}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$ToastXml</span> = [Windows.Data.Xml.Dom.XmlDocument]::new()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$ToastXml</span>.LoadXml(<span style="color:#8be9fd;font-style:italic">$CleanContent</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Toast</span> = [Windows.UI.Notifications.ToastNotification]::new(<span style="color:#8be9fd;font-style:italic">$ToastXml</span>)
</span></span></code></pre></div><p>Now, armed with a toast object we can get to work on making it actionable. You can see what events are available as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">$Toast</span> | <span style="color:#8be9fd;font-style:italic">Get-Member</span> -MemberType Event
</span></span></code></pre></div><pre tabindex="0"><code class="language-output" data-lang="output">   TypeName: Windows.UI.Notifications.ToastNotification

Name      MemberType Definition
----      ---------- ----------
Activated Event      Windows.Foundation.TypedEventHandler`2[Windows.UI.Notifications.ToastNotification,System…
Dismissed Event      Windows.Foundation.TypedEventHandler`2[Windows.UI.Notifications.ToastNotification,Window…
Failed    Event      Windows.Foundation.TypedEventHandler`2[Windows.UI.Notifications.ToastNotification,Window…
</code></pre><p>Today we&rsquo;re interested in the Activated event, but you may want to experiment with Dismissed and Failed events depending on what you&rsquo;re wanting to achieve.</p>
<p>We define what will happen when a given event happens using <code>Register-ObjectEvent</code>.</p>
<p>For this demo we&rsquo;re creating a whole new toast when the first toast is activated. I&rsquo;m not going to talk that through section by section. You&rsquo;ll notice a switch statment at the top that drills into an <code>$Event</code> variable, this is created automatically and gives you information about how the event was triggered. Specifically here we&rsquo;re checking to see which item in our selection box was selected when the toast was activated.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">Register-ObjectEvent</span> -InputObject <span style="color:#8be9fd;font-style:italic">$Toast</span> -EventName Activated -Action {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">switch</span> (<span style="color:#8be9fd;font-style:italic">$Event</span>.SourceArgs[<span style="color:#bd93f9">1</span>].UserInput.value) {
</span></span><span style="display:flex;"><span>        Item1 {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$Text1</span> = <span style="color:#8be9fd;font-style:italic">New-BTText</span> -Content <span style="color:#f1fa8c">&#39;GIF: Picard Facepalm&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$ImagePath</span> = <span style="color:#f1fa8c">&#39;C:\temp\gifs\facepalm.gif&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Item2 {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$Text1</span> = <span style="color:#8be9fd;font-style:italic">New-BTText</span> -Content <span style="color:#f1fa8c">&#39;GIF: Get It Girl&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$ImagePath</span> = <span style="color:#f1fa8c">&#39;C:\temp\gifs\get-it-girl.gif&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Item3 {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$Text1</span> = <span style="color:#8be9fd;font-style:italic">New-BTText</span> -Content <span style="color:#f1fa8c">&#39;GIF: Seinfeld - Oh, right right right&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$ImagePath</span> = <span style="color:#f1fa8c">&#39;C:\temp\gifs\oh-right.gif&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Item4 {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$Text1</span> = <span style="color:#8be9fd;font-style:italic">New-BTText</span> -Content <span style="color:#f1fa8c">&#39;GIF: Bob Ross?&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">$ImagePath</span> = <span style="color:#f1fa8c">&#39;C:\temp\gifs\bob-ross.gif&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Image1</span> = <span style="color:#8be9fd;font-style:italic">New-BTImage</span> -Source <span style="color:#8be9fd;font-style:italic">$ImagePath</span> -HeroImage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$ImagePath2</span> = <span style="color:#f1fa8c">&#39;C:\Program Files\PowerShell\7-preview\assets\Powershell_av_colors.ico&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Image2</span> = <span style="color:#8be9fd;font-style:italic">New-BTImage</span> -Source <span style="color:#8be9fd;font-style:italic">$ImagePath2</span> -AppLogoOverride -Crop None
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Audio1</span> = <span style="color:#8be9fd;font-style:italic">New-BTAudio</span> -Source <span style="color:#f1fa8c">&#39;ms-winsoundevent:Notification.Default&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Binding1</span> = <span style="color:#8be9fd;font-style:italic">New-BTBinding</span> -Children <span style="color:#8be9fd;font-style:italic">$Text1</span> -HeroImage <span style="color:#8be9fd;font-style:italic">$Image1</span> -AppLogoOverride <span style="color:#8be9fd;font-style:italic">$Image2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Visual1</span> = <span style="color:#8be9fd;font-style:italic">New-BTVisual</span> -BindingGeneric <span style="color:#8be9fd;font-style:italic">$Binding1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Content1</span> = <span style="color:#8be9fd;font-style:italic">New-BTContent</span> -Visual <span style="color:#8be9fd;font-style:italic">$Visual1</span> -Audio <span style="color:#8be9fd;font-style:italic">$Audio1</span> -Duration Long
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$Content1</span>.GetContent().Replace(<span style="color:#f1fa8c">&#39;&lt;text&gt;{&#39;</span>, <span style="color:#f1fa8c">&#39;&lt;text&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;}&lt;/text&gt;&#39;</span>, <span style="color:#f1fa8c">&#39;&lt;/text&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;=&#34;{&#39;</span>, <span style="color:#f1fa8c">&#39;=&#34;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$CleanContent</span> = <span style="color:#8be9fd;font-style:italic">$CleanContent</span>.Replace(<span style="color:#f1fa8c">&#39;}&#34; &#39;</span>, <span style="color:#f1fa8c">&#39;&#34; &#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$AppId</span> = <span style="color:#f1fa8c">&#39;Microsoft.AutoGenerated.{CD9EFC53-1ACE-EA00-530A-3EC179D1971C}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$ToastXml</span> = [Windows.Data.Xml.Dom.XmlDocument]::new()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$ToastXml</span>.LoadXml(<span style="color:#8be9fd;font-style:italic">$CleanContent</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$Toast</span> = [Windows.UI.Notifications.ToastNotification]::new(<span style="color:#8be9fd;font-style:italic">$ToastXml</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier(<span style="color:#8be9fd;font-style:italic">$AppId</span>).Show(<span style="color:#8be9fd;font-style:italic">$Toast</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Finally, we pop our first toast. This will look familiar if you read through the event registration above as that too ends with popping the second toast.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>[Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier(<span style="color:#8be9fd;font-style:italic">$AppId</span>).Show(<span style="color:#8be9fd;font-style:italic">$Toast</span>)
</span></span></code></pre></div><p>And with that, your toast will pop up and you&rsquo;ll be able to select what shows on the second. Do note that you&rsquo;ll have to supply your own gifs and point to them inside the event&rsquo;s switch statement.</p>
<h2 id="exploring-the-event-variable">Exploring the $Event Variable</h2>
<p>In the previous example I pinpointed the info that we needed from the $Event variable. What do you do if you want to poke around that variable yourself to see what it contains?</p>
<p>I like to register an event that just assigns that variable to a globally scoped variable which I can use from anywhere.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">Register-ObjectEvent</span> -InputObject <span style="color:#8be9fd;font-style:italic">$Toast</span> -EventName Activated -Action {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">$global:Testing</span> = <span style="color:#8be9fd;font-style:italic">$Event</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can now interrogate <code>$Testing</code> at your leisure, though to narrow things down a bit the interesting stuff is all under the SourceArgs property.</p>
<p>In all of my experiments so far, <code>$Testing.SourceArgs</code> has contained two objects. The first is the toast object, allowing you to inspect the XML and other information about the toast. The second object, however, contains any arguments (from the button pressed) and user input (from text boxes or selection boxes.)</p>
<p>This is where you can interrogate any input you may need to make decisions on what specific action to take based on feedback from the user.</p>
<h2 id="next-steps-and-unknowns">Next Steps and Unknowns</h2>
<p>I’m currently planning out what needs to be done for the next release of BurntToast. Regarding making actionable toasts easier to work with I’m planning to add some way of using specifying code to trigger on events via both <code>New-BurntToastNotification</code> and <code>Submit-BTNotification</code>.</p>
<p>This will probably take the form of ActivatedEvent and DismissedEvent parameters that accept a script block, though I’m open to suggestions on that front. I’m wondering about the failed event too; this may only be exposed against <code>Submit-BTNotification</code>.</p>
<p>I still have a few unknowns too. This has so far only been tested in a session on my local computer and I’m not sure what the interaction would be regarding remote sessions. Remembering the remote endpoint would need to be on PowerShell 7.1, it will depend on how long the session stays open. If it closes immediately after the toast is sent, then the event registration will be lost, and nothing will trigger.</p>
<p>Regardless, this is a very exciting time in the work of toast notifications. All those use cases I’ve been shelving for half a decade can be revisited and there’s more testing needed than there is time in the day.</p>
<p>If you’re interested in seeing some of these use cases in action, make sure you tune into <a href="https://www.twitch.tv/devopsorg" target="_blank" rel="noopener">PSPowerHour</a>
 towards the end of September (keep an eye on <a href="https://twitter.com/WindosNZ" target="_blank" rel="noopener">Twitter</a>
 for details) where I’ll be presenting &ldquo;<a href="https://sessionize.com/s/windos/croque_monsieur_step_up_your_toast_/34007" target="_blank" rel="noopener">Croque Monsieur: Step up Your Toast Notification Game</a>
&rdquo;.</p>
<p>If you&rsquo;ve got any questions about these actionable toasts that might need a bit of depth, please do feel free to open a new <a href="https://github.com/Windos/BurntToast/discussions" target="_blank" rel="noopener">discussion over on GitHub</a>
.</p>
<h2 id="credit">Credit</h2>
<p>Hero image by <a href="https://unsplash.com/@kate_gliz?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Kate Hliznitsova</a>
 on <a href="https://unsplash.com/s/photos/cracked-egg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a>
</p>

  </article><div class="bg-blue-300 dark:bg-gray-900">
  <div class="container px-6 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
    <div>
      <div class="text-2xl font-bold mb-2">Follow me</div>
      <p class="opacity-60"></p>
    </div>
    <ul class="flex justify-center gap-4">

      <li>
        <a
          href="https://twitter.com/WindosNZ"
          target="_blank"
          rel="noopener"
          aria-label="Twitter"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"
            />
          </svg>
        </a>
      </li>


      <li>
        <a
          href="https://linkedin.com/in/windos"
          target="_blank"
          rel="noopener"
          aria-label="LinkedIn"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>



      <li>
        <a
          href="https://github.com/Windos"
          target="_blank"
          rel="noopener"
          aria-label="GitHub"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"
            />
          </svg>
        </a>
      </li>





      <li>
        <a
          href="https://www.youtube.com/c/JoshuaKingSolari"
          target="_blank"
          rel="noopener"
          aria-label="YouTube"
          class="p-2 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-brand-youtube"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <circle cx="12" cy="12" r="9" />
            <path d="M10 9l5 3l-5 3z" />
          </svg>
        </a>
      </li>




    </ul>
  </div>
</div>
    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">

    Copyright © 2022 - Josh King · All rights reserved

  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12" />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="https://blog.toastit.dev/js/scripts.min.js"></script>







<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
